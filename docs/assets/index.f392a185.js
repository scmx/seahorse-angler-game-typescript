var M=Object.defineProperty;var F=(h,e,t)=>e in h?M(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var i=(h,e,t)=>(F(h,typeof e!="symbol"?e+"":e,t),t);const T=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}};T();const c=["ArrowLeft","h"],y=["ArrowDown","j"],w=["ArrowUp","k"],u=["ArrowRight","l"],S=[...c,...y,...w,...u],x=[" ","Enter","0"],f=new Map,X=sfxr.toAudio("9BbhBjsLbFTwNjJD9ThUzKTqFCFUwaUMdwobSWj2HGfkqVjEJP6sVUr8TNvCnNWRtReebPpxZfMySaeL9wBr89Wuv9RP6K1zyUtUctif5HB1ZsHoghr7Ax9Bs");function l(h){let e=f.get(h);e||(e=sfxr.generate(h),f.set(h,e)),sfxr.play(e)}class b{constructor(e){i(this,"game");this.game=e,window.addEventListener("keydown",t=>{S.includes(t.key)||x.includes(t.key)?this.game.keys.add(t.key):t.key==="d"&&(this.game.debug=!this.game.debug)}),window.addEventListener("keyup",t=>{this.game.keys.has(t.key)&&this.game.keys.delete(t.key)})}}class p{constructor(e,{x:t,y:s}){i(this,"game");i(this,"x");i(this,"y");i(this,"image");i(this,"width",10);i(this,"height",3);i(this,"xMax");i(this,"speed",3);i(this,"markedForDeletion",!1);this.game=e,this.x=t,this.y=s,this.image=m("projectile"),this.xMax=Math.min(e.width*.95,e.width*.7+t)}update(e){this.x+=this.speed,this.x>this.xMax&&(this.markedForDeletion=!0)}draw(e){this.game.debug&&e.strokeRect(this.x,this.y,this.width,this.height),e.drawImage(this.image,this.x,this.y)}}class g{constructor(e,t,s){i(this,"game");i(this,"x");i(this,"y");i(this,"image");i(this,"frameX");i(this,"frameY");i(this,"spriteSize",50);i(this,"sizeModifier");i(this,"size");i(this,"speedX");i(this,"speedY");i(this,"gravity",.5);i(this,"markedForDeletion",!1);i(this,"angle",0);i(this,"va");i(this,"bounced",0);i(this,"bottomBounceBoundary",Math.random()*80+60);this.game=e,this.x=t,this.y=s,this.image=m("gears"),this.frameX=Math.floor(Math.random()*3),this.frameY=Math.floor(Math.random()*3),this.sizeModifier=Number((Math.random()*.5+.5).toFixed(1)),this.size=this.spriteSize*this.sizeModifier,this.speedX=Math.random()*6-3,this.speedY=Math.random()*-15,this.va=Math.random()*.2-.1}update(){this.angle+=this.va,this.speedY+=this.gravity,this.x-=this.speedX+this.game.speed,this.y+=this.speedY,(this.y>this.game.height+this.size||this.x<0-this.size)&&(this.markedForDeletion=!0),this.y>this.game.height-this.bottomBounceBoundary&&this.bounced<2&&(this.bounced++,this.speedY*=-.7)}draw(e){e.save(),e.translate(this.x,this.y),e.rotate(this.angle),e.drawImage(this.image,this.frameX*this.spriteSize,this.frameY*this.spriteSize,this.spriteSize,this.spriteSize,0,0,this.size,this.size),e.restore()}}class Y{constructor(e){i(this,"game");i(this,"image");i(this,"width",120);i(this,"height",190);i(this,"x",20);i(this,"y",100);i(this,"frameX",0);i(this,"frameY",0);i(this,"maxFrame",37);i(this,"speedX",0);i(this,"speedY",0);i(this,"maxSpeed",2);i(this,"projectiles",new Set);i(this,"powerUp",!1);i(this,"powerUpTimer",0);i(this,"powerUpLimit",1e4);i(this,"shootTimer",0);i(this,"shootInterval",100);this.game=e,this.image=m("player")}update(e){c.some(o=>this.game.keys.has(o))?this.speedX=-this.maxSpeed:u.some(o=>this.game.keys.has(o))?this.speedX=this.maxSpeed:this.speedX=0,this.shootTimer<this.shootInterval?this.shootTimer+=e:x.some(o=>this.game.keys.has(o))&&(this.shootTop(),this.shootTimer=0);const t=20,s=this.game.width*.5-this.width*.5;this.x=Math.max(t,Math.min(s,this.x+this.speedX)),w.some(o=>this.game.keys.has(o))?this.speedY=-this.maxSpeed:y.some(o=>this.game.keys.has(o))?this.speedY=this.maxSpeed:this.speedY=0;const a=-this.height*.5,r=this.game.height-this.height*.5;this.y=Math.max(a,Math.min(r,this.y+this.speedY));for(const o of this.projectiles)o.update(e);this.frameX<this.maxFrame?this.frameX++:this.frameX=0,this.powerUp&&(this.powerUpTimer>this.powerUpLimit?(this.powerUpTimer=0,this.powerUp=!1,this.frameY=0):(this.powerUpTimer+=e,this.frameY=1,this.game.gameOver||(this.game.ammo+=.1)))}draw(e){this.game.debug&&e.strokeRect(this.x,this.y,this.width,this.height),e.drawImage(this.image,this.frameX*this.width,this.frameY*this.height,this.width,this.height,this.x,this.y,this.width,this.height);for(const t of this.projectiles)t.draw(e)}shootTop(){l("laserShoot"),this.game.ammo>0&&(this.projectiles.add(new p(this.game,{x:this.x+80,y:this.y+30})),this.game.ammo--),this.powerUp&&this.shootBottom()}shootBottom(){this.game.ammo>0&&this.projectiles.add(new p(this.game,{x:this.x+80,y:this.y+175}))}enterPowerUp(){l("powerUp"),this.powerUpTimer=0,this.powerUp=!0,this.game.ammo<this.game.maxAmmo&&(this.game.ammo=this.game.maxAmmo)}takeDamage(){l("explosion"),this.game.score--}}class d{constructor(e,t){i(this,"game");i(this,"x",100);i(this,"y",100);i(this,"speedX");i(this,"width");i(this,"height");i(this,"markedForDeletion",!1);i(this,"lives",5);i(this,"score");i(this,"image");i(this,"frameX",0);i(this,"frameY",0);i(this,"maxFrame",37);i(this,"type","");this.game=e,this.image=t,this.x=e.width,this.speedX=Math.random()*-1.5-.5,this.width=50,this.height=50,this.score=this.lives}update(){this.x+=this.speedX,this.x+this.width<0&&(this.markedForDeletion=!0),this.frameX<this.maxFrame?this.frameX++:this.frameX=0}draw(e){this.game.debug&&e.strokeRect(this.x,this.y,this.width,this.height),e.drawImage(this.image,this.frameX*this.width,this.frameY*this.height,this.width,this.height,this.x,this.y,this.width,this.height),this.game.debug&&(e.font="20px Helvetica",e.fillText(`${this.lives}`,this.x,this.y))}}class U extends d{constructor(t){super(t,m("angler1"));i(this,"frameY");i(this,"lives",5);i(this,"width",228);i(this,"height",169);this.y=Math.random()*(this.game.height*.95-this.height),this.frameY=Math.floor(Math.random()*3),this.score=this.lives}}class D extends d{constructor(t){super(t,m("angler2"));i(this,"frameY");i(this,"lives",6);i(this,"width",213);i(this,"height",165);this.y=Math.random()*(this.game.height*.95-this.height),this.frameY=Math.floor(Math.random()*2),this.score=this.lives}}class E extends d{constructor(t){super(t,m("lucky"));i(this,"frameY");i(this,"lives",5);i(this,"type","lucky");i(this,"width",99);i(this,"height",95);i(this,"score",15);this.y=Math.random()*(this.game.height*.95-this.height),this.frameY=Math.floor(Math.random()*2)}}class z extends d{constructor(t){super(t,m("hivewhale"));i(this,"frameY",0);i(this,"lives",20);i(this,"type","hive");i(this,"width",400);i(this,"height",227);this.y=Math.random()*(this.game.height*.95-this.height),this.score=this.lives,this.speedX=Math.random()*-1.2-.2}}class L extends d{constructor(t,s,a){super(t,m("drone"));i(this,"frameY");i(this,"lives",3);i(this,"type","drone");i(this,"width",115);i(this,"height",95);this.x=s,this.y=a,this.frameY=Math.floor(Math.random()*2),this.score=this.lives,this.speedX=Math.random()*-4.2-.5}}class n{constructor(e,t,s){i(this,"game");i(this,"image");i(this,"speedModifier");i(this,"width",1768);i(this,"height",500);i(this,"x",0);i(this,"y",0);this.game=e,this.image=t,this.speedModifier=s}update(e){this.x<=-this.width&&(this.x=0),this.x-=this.game.speed*this.speedModifier}draw(e){e.drawImage(this.image,this.x,this.y),e.drawImage(this.image,this.x+this.width,this.y)}}class O{constructor(e){i(this,"game");i(this,"layer1");i(this,"layer2");i(this,"layer3");i(this,"layer4");i(this,"layers",[]);this.game=e,this.layer1=new n(this.game,m("layer1"),.5),this.layer2=new n(this.game,m("layer2"),.8),this.layer3=new n(this.game,m("layer3"),1.2),this.layer4=new n(this.game,m("layer4"),1.5),this.layers.push(this.layer1,this.layer2,this.layer3,this.layer4)}update(e){for(const t of this.layers)t.update(e)}draw(e){for(const t of this.layers)t.draw(e)}}class v{constructor(e,t,s,a){i(this,"game");i(this,"x");i(this,"y");i(this,"image");i(this,"frameX",0);i(this,"width",200);i(this,"height",200);i(this,"fps",30);i(this,"timer",0);i(this,"interval");i(this,"markedForDeletion",!1);i(this,"maxFrame",8);this.game=e,this.x=t-this.width*.5,this.y=s-this.height*.5,this.image=a,this.interval=1e3/this.fps}update(e){this.x-=this.game.speed,this.timer>this.interval?(this.frameX++,this.timer=0):this.timer+=e,this.frameX>this.maxFrame&&(this.markedForDeletion=!0)}draw(e){e.drawImage(this.image,this.frameX*this.width,0,this.width,this.height,this.x,this.y,this.width,this.height)}}class I extends v{constructor(e,t,s){super(e,t,s,m("smokeExplosion"))}}class j extends v{constructor(e,t,s){super(e,t,s,m("fireExplosion"))}}class A{constructor(e){i(this,"game");i(this,"fontSize",25);i(this,"fontFamily","Bangers, cursive");i(this,"color","white");this.game=e}draw(e){e.save(),e.fillStyle=this.color,e.shadowOffsetX=2,e.shadowOffsetY=1,e.shadowColor="black",e.font=`${this.fontSize}px ${this.fontFamily}`,e.fillText(`Score: ${this.game.score}`,20,40);const t=(this.game.gameTime*.001).toFixed(1);e.fillText(`Timer: ${t}`,20,100);let s,a;this.game.gameOver&&(this.game.score>this.game.winningScore?(e.textAlign="center",s="Most Wondrous!",a="Well done explorer!"):(s="Blazes!",a="Get my repair kit and try again!"),e.textAlign="center",e.font=`70px ${this.fontFamily}`,e.fillText(s,this.game.width*.5,this.game.height*.5-20),e.font=`25px ${this.fontFamily}`,e.fillText(a,this.game.width*.5,this.game.height*.5+20)),this.game.player.powerUp&&(e.fillStyle="#ffffbd");for(let r=0;r<this.game.ammo;r++)e.fillRect(20+5*r,50,3,20);e.restore()}}class B{constructor(e,t){i(this,"debug",!1);i(this,"width");i(this,"height");i(this,"player");i(this,"background");i(this,"input");i(this,"ui");i(this,"keys",new Set);i(this,"particles",new Set);i(this,"explosions",new Set);i(this,"enemies",new Set);i(this,"enemyTimer",0);i(this,"enemyInterval",2e3);i(this,"ammo",20);i(this,"maxAmmo",50);i(this,"ammoTimer",0);i(this,"ammoInterval",350);i(this,"speed",1);i(this,"gameOver",!1);i(this,"gameOverTime",0);i(this,"gameTime",0);i(this,"timeLimit",3e4);i(this,"score",0);i(this,"winningScore",80);this.width=e,this.height=t,this.background=new O(this),this.player=new Y(this),this.input=new b(this),this.ui=new A(this)}update(e){this.gameOver||(this.gameTime+=e,this.gameTime>this.timeLimit&&this.score<this.winningScore&&(this.gameOver=!0,this.gameOverTime=Date.now())),this.background.update(e),this.player.update(e),this.ammoTimer>this.ammoInterval?(this.ammo<this.maxAmmo&&this.ammo++,this.ammoTimer=0):this.ammoTimer+=e;for(const s of this.particles)s.update(),s.markedForDeletion&&this.particles.delete(s);for(const s of this.explosions)s.update(e),s.markedForDeletion&&this.explosions.delete(s);for(const s of this.enemies){if(s.update(),this.checkCollision(this.player,s)){s.markedForDeletion=!0,this.addExplosion(s);for(let a=0;a<s.lives;a++)this.particles.add(new g(this,s.x+s.width*.5,s.y+s.height*.5));s.type==="lucky"?this.player.enterPowerUp():this.gameOver||this.player.takeDamage()}for(const a of this.player.projectiles){if(this.checkCollision(a,s)&&(s.lives--,a.markedForDeletion=!0,this.particles.add(new g(this,s.x+s.width*.5,s.y+s.height*.5)),s.lives<=0)){for(let r=0;r<s.lives;r++)this.particles.add(new g(this,s.x+s.width*.5,s.y+s.height*.5));if(s.markedForDeletion=!0,this.addExplosion(s),X.play(),s.type==="hive")for(let r=0;r<5;r++)this.enemies.add(new L(this,s.x+Math.random()*s.width,s.y+Math.random()*s.height*.5));this.gameOver||(this.score+=s.score)}a.markedForDeletion&&this.player.projectiles.delete(a)}s.markedForDeletion&&this.enemies.delete(s)}const t=this.enemyInterval/Math.max(1,Math.min(200,this.score))**(1/3);this.enemyTimer>t&&!this.gameOver?(this.addEnemy(),this.enemyTimer=0):this.enemyTimer+=e}draw(e){this.background.draw(e),this.gameOver||this.ui.draw(e),this.player.draw(e);for(const t of this.particles)t.draw(e);for(const t of this.enemies)t.draw(e);for(const t of this.explosions)t.draw(e);this.background.layer4.draw(e),this.gameOver&&this.ui.draw(e)}addEnemy(){const e=Math.random();e<.3?this.enemies.add(new U(this)):e<.6?this.enemies.add(new D(this)):e<.7?this.enemies.add(new z(this)):this.enemies.add(new E(this))}addExplosion(e){Math.random()<.5?this.explosions.add(new I(this,e.x+e.width*.5,e.y+e.height*.5)):this.explosions.add(new j(this,e.x+e.width*.5,e.y+e.height*.5))}checkCollision(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.height+e.y>t.y}}addEventListener("load",()=>{let h=document.querySelector("#canvas1");const e=h.getContext("2d");h.width=1e3,h.height=500;let t;function s(){t=new B(h.width,h.height)}s(),window.addEventListener("keydown",()=>{t.gameOver&&t.gameOverTime+5e3<Date.now()&&s()});let a=0;function r(o){const k=o-a;a=o,e.clearRect(0,0,h.width,h.height),t.draw(e),t.update(k),requestAnimationFrame(r)}requestAnimationFrame(r)});addEventListener("error",h=>{const e=document.createElement("div");e.innerHTML=`
  ${h.error.name}
  <br>
  ${h.error.message}
  <br/>
  ${h.error.trace}
  `,document.querySelector("#error").appendChild(e)});function m(h){return document.getElementById(h)}
